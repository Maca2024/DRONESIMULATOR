# CONTEXT.md - Aetherwing Technical Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—   â•‘
â•‘    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â•‘
â•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â•‘
â•‘    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â•‘
â•‘    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â•‘
â•‘    â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â•   â•‘
â•‘                                                                               â•‘
â•‘                    TECHNICAL ARCHITECTURE DOCUMENT                            â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

Dit document beschrijft de volledige technische architectuur van de Aetherwing Drone Simulator, inclusief alle systemen, dataflows, en implementatiedetails.

---

## Inhoudsopgave

1. [Systeemoverzicht](#1-systeemoverzicht)
2. [Bestandsstructuur](#2-bestandsstructuur)
3. [Core Systems](#3-core-systems)
4. [State Management](#4-state-management)
5. [Physics Engine](#5-physics-engine)
6. [Input System](#6-input-system)
7. [Game Systems](#7-game-systems)
8. [Rendering Pipeline](#8-rendering-pipeline)
9. [Audio System](#9-audio-system)
10. [UI Components](#10-ui-components)
11. [Data Types](#11-data-types)
12. [Configuration Constants](#12-configuration-constants)
13. [Game Loop](#13-game-loop)
14. [Performance Considerations](#14-performance-considerations)
15. [Extensibility Guide](#15-extensibility-guide)

---

## 1. Systeemoverzicht

### 1.1 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AETHERWING ARCHITECTURE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         PRESENTATION LAYER                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ React UI â”‚  â”‚ Three.js â”‚  â”‚ CSS      â”‚  â”‚ React Three Fiberâ”‚   â”‚   â”‚
â”‚  â”‚  â”‚ Componentsâ”‚  â”‚ 3D Scene â”‚  â”‚ Modules  â”‚  â”‚ (Bridge)         â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          LOGIC LAYER                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Game Manager â”‚  â”‚ Camera       â”‚  â”‚ Game Systems             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (Hook)       â”‚  â”‚ Controller   â”‚  â”‚ (Tutorial, Mission, Audio)â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         STATE LAYER                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Game     â”‚  â”‚ Input    â”‚  â”‚ Settings â”‚  â”‚ Progress         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ Store    â”‚  â”‚ Store    â”‚  â”‚ Store    â”‚  â”‚ Store            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        SIMULATION LAYER                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                    PHYSICS ENGINE (500Hz)                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚   Thrust â†’ Torque â†’ Forces â†’ Integration â†’ State Update      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Technologie Stack

| Component | Technologie | Versie | Doel |
|-----------|-------------|--------|------|
| **Framework** | React | 18.2 | UI Component Model |
| **3D Engine** | Three.js | 0.160 | WebGL Rendering |
| **3D Bridge** | React Three Fiber | 8.15 | Declarative 3D |
| **State** | Zustand | 4.4 | State Management |
| **Build** | Vite | 5.0 | Development & Build |
| **Language** | TypeScript | 5.3 | Type Safety |
| **Desktop** | Electron | 28.0 | Native App |
| **Testing** | Vitest | 1.0 | Unit Testing |
| **Audio** | Web Audio API | Native | Sound Synthesis |

---

## 2. Bestandsstructuur

### 2.1 Complete File Tree

```
DRONESIMULATOR/
â”‚
â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ renderer/                      # Hoofdapplicatie code
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ core/                      # Core engine componenten
â”‚   â”‚   â”‚   â”œâ”€â”€ PhysicsEngine.ts          # [477 lines] Quadcopter physics
â”‚   â”‚   â”‚   â””â”€â”€ PhysicsEngine.test.ts     # [248 lines] Physics tests
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ store/                     # Zustand state stores
â”‚   â”‚   â”‚   â”œâ”€â”€ gameStore.ts              # [168 lines] Game state
â”‚   â”‚   â”‚   â”œâ”€â”€ inputStore.ts             # [385 lines] Input handling
â”‚   â”‚   â”‚   â”œâ”€â”€ settingsStore.ts          # [136 lines] Settings (persisted)
â”‚   â”‚   â”‚   â””â”€â”€ progressStore.ts          # [98 lines] Player progress
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ systems/                   # Game subsystems
â”‚   â”‚   â”‚   â”œâ”€â”€ TutorialSystem.ts         # [410 lines] Training system
â”‚   â”‚   â”‚   â”œâ”€â”€ MissionSystem.ts          # [399 lines] Mission management
â”‚   â”‚   â”‚   â””â”€â”€ AudioSystem.ts            # [402 lines] Procedural audio
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/                     # Custom React hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ useGameManager.ts         # [176 lines] Game loop coordinator
â”‚   â”‚   â”‚   â””â”€â”€ useCameraController.ts    # [203 lines] Camera modes
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/                # 3D React components
â”‚   â”‚   â”‚   â”œâ”€â”€ DroneModel.tsx            # [230 lines] Quadcopter mesh
â”‚   â”‚   â”‚   â”œâ”€â”€ Terrain.tsx               # [312 lines] Procedural terrain
â”‚   â”‚   â”‚   â”œâ”€â”€ Environment.tsx           # [145 lines] Sky & lighting
â”‚   â”‚   â”‚   â”œâ”€â”€ ParticleEffects.tsx       # [198 lines] Thrust particles
â”‚   â”‚   â”‚   â””â”€â”€ PostProcessingEffects.tsx # [67 lines] Visual effects
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ scenes/                    # 3D scene compositions
â”‚   â”‚   â”‚   â”œâ”€â”€ GameScene.tsx             # [456 lines] Main scene
â”‚   â”‚   â”‚   â””â”€â”€ Drone.tsx                 # [178 lines] Drone scene wrapper
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ ui/                        # 2D UI components
â”‚   â”‚   â”‚   â”œâ”€â”€ MainMenu.tsx              # [156 lines] Start menu
â”‚   â”‚   â”‚   â”œâ”€â”€ HUD.tsx                   # [142 lines] Flight telemetry
â”‚   â”‚   â”‚   â”œâ”€â”€ EnhancedHUD.tsx           # [198 lines] Advanced HUD
â”‚   â”‚   â”‚   â”œâ”€â”€ SettingsPanel.tsx         # [423 lines] Settings UI
â”‚   â”‚   â”‚   â”œâ”€â”€ PauseMenu.tsx             # [45 lines] Pause screen
â”‚   â”‚   â”‚   â”œâ”€â”€ TutorialOverlay.tsx       # [112 lines] Tutorial UI
â”‚   â”‚   â”‚   â”œâ”€â”€ MissionHUD.tsx            # [156 lines] Mission display
â”‚   â”‚   â”‚   â”œâ”€â”€ ControlsHint.tsx          # [98 lines] Control hints
â”‚   â”‚   â”‚   â””â”€â”€ LoadingScreen.tsx         # [23 lines] Loading indicator
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ audio/                     # Enhanced audio
â”‚   â”‚   â”‚   â””â”€â”€ EnhancedAudioSystem.ts    # [345 lines] Advanced audio
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.tsx                       # [144 lines] Root component
â”‚   â”‚   â””â”€â”€ main.tsx                      # [12 lines] Entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ shared/                        # Gedeelde code
â”‚   â”‚   â”œâ”€â”€ types.ts                      # [255 lines] TypeScript types
â”‚   â”‚   â”œâ”€â”€ types.test.ts                 # [89 lines] Type tests
â”‚   â”‚   â”œâ”€â”€ constants.ts                  # [193 lines] Configuration
â”‚   â”‚   â””â”€â”€ constants.test.ts             # [76 lines] Constants tests
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ test/                          # Test utilities
â”‚   â”‚   â””â”€â”€ setup.ts                      # [34 lines] Test config
â”‚   â”‚
â”‚   â””â”€â”€ vite-env.d.ts                     # Vite type declarations
â”‚
â”œâ”€â”€ ğŸ“ node_modules/                      # Dependencies
â”‚
â”œâ”€â”€ ğŸ“„ index.html                         # HTML entry point
â”œâ”€â”€ ğŸ“„ package.json                       # Dependencies & scripts
â”œâ”€â”€ ğŸ“„ package-lock.json                  # Lock file
â”œâ”€â”€ ğŸ“„ tsconfig.json                      # TypeScript config
â”œâ”€â”€ ğŸ“„ tsconfig.node.json                 # Node TypeScript config
â”œâ”€â”€ ğŸ“„ vite.config.ts                     # Vite configuration
â”œâ”€â”€ ğŸ“„ vitest.config.ts                   # Vitest configuration
â”œâ”€â”€ ğŸ“„ .eslintrc.cjs                      # ESLint rules
â”œâ”€â”€ ğŸ“„ .prettierrc                        # Prettier config
â”œâ”€â”€ ğŸ“„ .gitignore                         # Git ignore rules
â”œâ”€â”€ ğŸ“„ README.md                          # Project documentation
â”œâ”€â”€ ğŸ“„ CONTEXT.md                         # Dit bestand
â””â”€â”€ ğŸ“„ CLAUDE.md                          # Claude AI context
```

### 2.2 Module Dependencies

```
                           App.tsx
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
         GameScene.tsx   UI Components   Zustand Stores
              â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚         â”‚     â”‚     â”‚         â”‚         â”‚
    â–¼         â–¼         â–¼     â”‚     â–¼         â–¼         â–¼
DroneModel Terrain  Environmentâ”‚  gameStore inputStore settingsStore
    â”‚         â”‚         â”‚     â”‚     â”‚         â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    shared/types.ts
                    shared/constants.ts
```

---

## 3. Core Systems

### 3.1 System Initialization Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        APPLICATION STARTUP SEQUENCE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. main.tsx                                                                â”‚
â”‚     â””â”€â”€ ReactDOM.createRoot()                                               â”‚
â”‚         â””â”€â”€ <App />                                                         â”‚
â”‚                                                                             â”‚
â”‚  2. App.tsx mounts                                                          â”‚
â”‚     â”œâ”€â”€ useEffect: inputStore.initialize()                                  â”‚
â”‚     â”‚   â””â”€â”€ Register keyboard, mouse, gamepad listeners                     â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â”œâ”€â”€ useEffect: Load settings from localStorage                          â”‚
â”‚     â”‚   â””â”€â”€ settingsStore.hydrate()                                         â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â””â”€â”€ Render conditional UI based on currentScreen                        â”‚
â”‚                                                                             â”‚
â”‚  3. User clicks "Start Game" (freePlay/tutorial/mission)                    â”‚
â”‚     â””â”€â”€ gameStore.startGame({ mode, missionId? })                           â”‚
â”‚         â””â”€â”€ setScreen('freePlay' | 'tutorial' | 'mission')                  â”‚
â”‚                                                                             â”‚
â”‚  4. GameScene.tsx mounts (inside React Three Fiber Canvas)                  â”‚
â”‚     â”œâ”€â”€ useGameManager() hook initializes:                                  â”‚
â”‚     â”‚   â”œâ”€â”€ PhysicsEngine instance                                          â”‚
â”‚     â”‚   â”œâ”€â”€ TutorialSystem instance (if tutorial mode)                      â”‚
â”‚     â”‚   â”œâ”€â”€ MissionSystem instance (if mission mode)                        â”‚
â”‚     â”‚   â””â”€â”€ AudioSystem instance                                            â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â””â”€â”€ useFrame() starts game loop (60 FPS)                                â”‚
â”‚                                                                             â”‚
â”‚  5. Game Loop Active                                                        â”‚
â”‚     â””â”€â”€ See Section 13: Game Loop                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 System Communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  InputStore  â”‚â”€â”€â”€â”€>â”‚ GameManager  â”‚â”€â”€â”€â”€>â”‚ PhysicsEngineâ”‚
â”‚              â”‚     â”‚   (Hook)     â”‚     â”‚              â”‚
â”‚ - keyboard   â”‚     â”‚              â”‚     â”‚ - position   â”‚
â”‚ - gamepad    â”‚     â”‚ - update()   â”‚     â”‚ - velocity   â”‚
â”‚ - normalized â”‚     â”‚ - reset()    â”‚     â”‚ - rotation   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                    â”‚
       â”‚                    â–¼                    â”‚
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
       â”‚           â”‚  GameStore   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚           â”‚              â”‚
       â”‚           â”‚ - droneState â”‚
       â”‚           â”‚ - score      â”‚
       â”‚           â”‚ - screen     â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TutorialSys  â”‚     â”‚ MissionSys   â”‚
â”‚              â”‚     â”‚              â”‚
â”‚ - tasks      â”‚     â”‚ - objectives â”‚
â”‚ - progress   â”‚     â”‚ - scoring    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. State Management

### 4.1 Zustand Store Architecture

```typescript
// Vier aparte stores voor separation of concerns

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ZUSTAND STORES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ gameStore.ts - Game State Management                                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ State:                                                              â”‚   â”‚
â”‚  â”‚   currentScreen: GameScreen        // 'mainMenu' | 'freePlay' | ... â”‚   â”‚
â”‚  â”‚   previousScreens: GameScreen[]    // Navigation history            â”‚   â”‚
â”‚  â”‚   isPlaying: boolean               // Game active flag              â”‚   â”‚
â”‚  â”‚   isPaused: boolean                // Pause state                   â”‚   â”‚
â”‚  â”‚   gameTime: number                 // Elapsed time (seconds)        â”‚   â”‚
â”‚  â”‚   score: number                    // Current score                 â”‚   â”‚
â”‚  â”‚   comboMultiplier: number          // Score multiplier (1.0 - 2.0)  â”‚   â”‚
â”‚  â”‚   drone: DroneState                // Full drone state              â”‚   â”‚
â”‚  â”‚   activeMission: string | null     // Current mission ID            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚ Actions:                                                            â”‚   â”‚
â”‚  â”‚   setScreen(screen)                // Navigate to screen            â”‚   â”‚
â”‚  â”‚   goBack()                         // Return to previous screen     â”‚   â”‚
â”‚  â”‚   startGame(options)               // Begin gameplay                â”‚   â”‚
â”‚  â”‚   pauseGame() / resumeGame()       // Pause control                 â”‚   â”‚
â”‚  â”‚   endGame()                        // Return to menu                â”‚   â”‚
â”‚  â”‚   updateDrone(partial)             // Update drone state            â”‚   â”‚
â”‚  â”‚   setFlightMode(mode)              // Change flight mode            â”‚   â”‚
â”‚  â”‚   toggleArm()                      // Arm/disarm drone              â”‚   â”‚
â”‚  â”‚   addScore(points)                 // Add to score                  â”‚   â”‚
â”‚  â”‚   handleCrash()                    // Process crash event           â”‚   â”‚
â”‚  â”‚   tick(dt)                         // Update game time              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ inputStore.ts - Input Handling                                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ State:                                                              â”‚   â”‚
â”‚  â”‚   keys: Map<string, KeyState>      // Keyboard key states           â”‚   â”‚
â”‚  â”‚   mouse: MouseState                // Mouse position/buttons        â”‚   â”‚
â”‚  â”‚   gamepad: GamepadState | null     // Connected gamepad             â”‚   â”‚
â”‚  â”‚   config: InputConfig              // Sensitivity, deadzone, etc.   â”‚   â”‚
â”‚  â”‚   activeSource: InputSource        // Current input method          â”‚   â”‚
â”‚  â”‚   normalized: NormalizedInput      // Processed output              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚ Actions:                                                            â”‚   â”‚
â”‚  â”‚   initialize()                     // Setup event listeners         â”‚   â”‚
â”‚  â”‚   cleanup()                        // Remove event listeners        â”‚   â”‚
â”‚  â”‚   update()                         // Poll inputs each frame        â”‚   â”‚
â”‚  â”‚   setConfig(config)                // Update input config           â”‚   â”‚
â”‚  â”‚   calculateNormalizedInput()       // Process raw â†’ normalized      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ settingsStore.ts - Persistent Settings                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ State:                                                              â”‚   â”‚
â”‚  â”‚   graphics: GraphicsSettings       // Resolution, quality, etc.     â”‚   â”‚
â”‚  â”‚   audio: AudioSettings             // Volume levels                 â”‚   â”‚
â”‚  â”‚   controls: ControlSettings        // Key bindings, sensitivity     â”‚   â”‚
â”‚  â”‚   accessibility: AccessibilitySettings // A11y options              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚ Persistence:                                                        â”‚   â”‚
â”‚  â”‚   - Automatically saved to localStorage                             â”‚   â”‚
â”‚  â”‚   - Loaded on app startup                                           â”‚   â”‚
â”‚  â”‚   - Key: 'aetherwing-settings'                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ progressStore.ts - Player Progression                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ State:                                                              â”‚   â”‚
â”‚  â”‚   level: number                    // Player level                  â”‚   â”‚
â”‚  â”‚   xp: number                       // Experience points             â”‚   â”‚
â”‚  â”‚   tutorialProgress: Record<...>    // Completed tutorials           â”‚   â”‚
â”‚  â”‚   completedMissions: string[]      // Finished mission IDs          â”‚   â”‚
â”‚  â”‚   achievements: string[]           // Unlocked achievements         â”‚   â”‚
â”‚  â”‚   statistics: PlayerStatistics     // Flight stats                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚ Persistence:                                                        â”‚   â”‚
â”‚  â”‚   - Saved to localStorage                                           â”‚   â”‚
â”‚  â”‚   - Key: 'aetherwing-progress'                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Store Selectors

```typescript
// gameStore selectors
export const selectDronePosition = (state: GameState) => state.drone.position;
export const selectIsArmed = (state: GameState) => state.drone.isArmed;
export const selectFlightMode = (state: GameState) => state.drone.flightMode;

// Usage in components:
const position = useGameStore(selectDronePosition);
const isArmed = useGameStore(selectIsArmed);
```

---

## 5. Physics Engine

### 5.1 Physics Engine Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PHYSICS ENGINE (500Hz)                              â”‚
â”‚                     src/renderer/core/PhysicsEngine.ts                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CONFIGURATION (PhysicsConfig)                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   mass: 0.5 kg              // Drone mass                           â”‚   â”‚
â”‚  â”‚   armLength: 0.15 m         // Motor arm length                     â”‚   â”‚
â”‚  â”‚   motorKv: 2400             // Motor Kv rating                      â”‚   â”‚
â”‚  â”‚   propDiameter: 0.127 m     // 5" propeller                         â”‚   â”‚
â”‚  â”‚   thrustCoefficient: 0.1    // Ct value                             â”‚   â”‚
â”‚  â”‚   torqueCoefficient: 0.01   // Cq value                             â”‚   â”‚
â”‚  â”‚   dragCoefficient: 0.5      // Cd value                             â”‚   â”‚
â”‚  â”‚   motorResponseRate: 0.1    // Motor RPM change rate                â”‚   â”‚
â”‚  â”‚   groundEffectHeight: 1.0   // Ground effect range                  â”‚   â”‚
â”‚  â”‚   groundEffectStrength: 0.3 // Ground effect multiplier             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ STATE (PhysicsState)                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   position: Vector3         // World position (meters)              â”‚   â”‚
â”‚  â”‚   velocity: Vector3         // Linear velocity (m/s)                â”‚   â”‚
â”‚  â”‚   rotation: Quaternion      // Orientation quaternion               â”‚   â”‚
â”‚  â”‚   angularVelocity: Vector3  // Angular velocity (rad/s)             â”‚   â”‚
â”‚  â”‚   motorRPM: [n, n, n, n]    // Individual motor RPMs                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ UPDATE CYCLE                                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   update(input, dt) {                                               â”‚   â”‚
â”‚  â”‚     1. calculateMotorRPMs(input)                                    â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Base RPM from throttle + differential for control        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     2. calculateTotalThrust()                                       â”‚   â”‚
â”‚  â”‚        â””â”€â”€ T = Ct Ã— Ï Ã— nÂ² Ã— Dâ´ for each motor                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     3. calculateTorque()                                            â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Differential thrust creates torque on each axis          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     4. applyGravity()                                               â”‚   â”‚
â”‚  â”‚        â””â”€â”€ F = m Ã— g (downward)                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     5. applyDrag()                                                  â”‚   â”‚
â”‚  â”‚        â””â”€â”€ F = 0.5 Ã— Cd Ã— Ï Ã— A Ã— vÂ²                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     6. applyGroundEffect()                                          â”‚   â”‚
â”‚  â”‚        â””â”€â”€ +30% thrust when altitude < 1m                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     7. integrateLinear(dt)                                          â”‚   â”‚
â”‚  â”‚        â””â”€â”€ position += velocity Ã— dt                                â”‚   â”‚
â”‚  â”‚        â””â”€â”€ velocity += acceleration Ã— dt                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     8. integrateAngular(dt)                                         â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Update quaternion from angular velocity                  â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Apply angular drag (0.95 multiplier)                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     9. enforceConstraints()                                         â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Ground collision (y >= 0)                                â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Altitude limit (y <= 500)                                â”‚   â”‚
â”‚  â”‚        â””â”€â”€ Boundary limits (|x|, |z| <= 500)                        â”‚   â”‚
â”‚  â”‚   }                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Motor Layout

```
              FRONT
                â”‚
    Motor 1     â”‚     Motor 2
    (CW)        â”‚     (CCW)
       â•²        â”‚        â•±
        â•²       â”‚       â•±
         â•²      â”‚      â•±
          â•²     â”‚     â•±
           â•²    â”‚    â•±
            â”€â”€â”€â”€â”¼â”€â”€â”€â”€
           â•±    â”‚    â•²
          â•±     â”‚     â•²
         â•±      â”‚      â•²
        â•±       â”‚       â•²
       â•±        â”‚        â•²
    Motor 4     â”‚     Motor 3
    (CCW)       â”‚     (CW)
                â”‚
              BACK

Motor Control Mixing:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Roll Right:  M1â†‘, M4â†‘, M2â†“, M3â†“
Roll Left:   M1â†“, M4â†“, M2â†‘, M3â†‘
Pitch Fwd:   M1â†“, M2â†“, M3â†‘, M4â†‘
Pitch Back:  M1â†‘, M2â†‘, M3â†“, M4â†“
Yaw Right:   M1â†‘, M3â†‘, M2â†“, M4â†“ (CW motors up)
Yaw Left:    M1â†“, M3â†“, M2â†‘, M4â†‘ (CCW motors up)
```

### 5.3 Physics Formulas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PHYSICS FORMULAS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  THRUST (per motor):                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚    T = Ct Ã— Ï Ã— nÂ² Ã— Dâ´                                                     â”‚
â”‚                                                                             â”‚
â”‚    Where:                                                                   â”‚
â”‚      Ct = Thrust coefficient (0.1)                                          â”‚
â”‚      Ï  = Air density (1.225 kg/mÂ³)                                         â”‚
â”‚      n  = Motor RPM / 60 (revolutions per second)                           â”‚
â”‚      D  = Propeller diameter (0.127 m for 5")                               â”‚
â”‚                                                                             â”‚
â”‚  TORQUE (reaction):                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚    Ï„ = Cq Ã— Ï Ã— nÂ² Ã— Dâµ                                                     â”‚
â”‚                                                                             â”‚
â”‚  HOVER THRUST:                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚    T_hover = m Ã— g / 4                                                      â”‚
â”‚    T_hover = 0.5 Ã— 9.81 / 4 = 1.226 N per motor                            â”‚
â”‚                                                                             â”‚
â”‚  DRAG:                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€                                                                      â”‚
â”‚    F_drag = 0.5 Ã— Cd Ã— Ï Ã— A Ã— vÂ²                                          â”‚
â”‚                                                                             â”‚
â”‚    Where:                                                                   â”‚
â”‚      Cd = Drag coefficient (0.5)                                            â”‚
â”‚      A  = Reference area (0.04 mÂ²)                                          â”‚
â”‚      v  = Velocity magnitude                                                â”‚
â”‚                                                                             â”‚
â”‚  GROUND EFFECT:                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚    T_actual = T Ã— (1 + GE_strength Ã— (1 - altitude / GE_height))           â”‚
â”‚                                                                             â”‚
â”‚    Active when altitude < GE_height (1.0 m)                                 â”‚
â”‚    Maximum +30% thrust at ground level                                      â”‚
â”‚                                                                             â”‚
â”‚  ANGULAR INTEGRATION (Quaternion):                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚    q' = q + 0.5 Ã— q Ã— Ï‰ Ã— dt                                               â”‚
â”‚    q  = normalize(q')                                                       â”‚
â”‚                                                                             â”‚
â”‚    Where:                                                                   â”‚
â”‚      q  = Current orientation quaternion                                    â”‚
â”‚      Ï‰  = Angular velocity as quaternion [0, Ï‰x, Ï‰y, Ï‰z]                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Input System

### 6.1 Input Processing Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INPUT PROCESSING PIPELINE                            â”‚
â”‚                      src/renderer/store/inputStore.ts                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  RAW INPUT                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                  â”‚
â”‚    Keyboard: keydown/keyup events â†’ keys Map                               â”‚
â”‚    Mouse: mousemove, wheel events â†’ mouse state                            â”‚
â”‚    Gamepad: navigator.getGamepads() polling â†’ gamepad state                â”‚
â”‚                                                                             â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚                                                                             â”‚
â”‚  ANALOG SIMULATION (for keyboard)                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚                                                                             â”‚
â”‚    Key State Machine:                                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  press  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hold   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚    â”‚  IDLE   â”‚ â”€â”€â”€â”€â”€â”€> â”‚ PRESSED â”‚ â”€â”€â”€â”€â”€â”€> â”‚ RAMPING â”‚                     â”‚
â”‚    â”‚ val=0   â”‚         â”‚ val=0.15â”‚         â”‚ valâ†’1.0 â”‚                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚         â–²                                        â”‚                          â”‚
â”‚         â”‚  release (decay)                       â”‚                          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                             â”‚
â”‚    Timing:                                                                  â”‚
â”‚      TAP_DURATION = 100ms    (initial press value: 15%)                    â”‚
â”‚      HOLD_RAMP_SPEED = 150ms (time to reach 100%)                          â”‚
â”‚      RELEASE_DECAY = 50ms    (time to return to 0%)                        â”‚
â”‚                                                                             â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚                                                                             â”‚
â”‚  DEADZONE APPLICATION                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚                                                                             â”‚
â”‚    if (|value| < deadzone) return 0                                        â”‚
â”‚    else return (value - deadzone) / (1 - deadzone)                         â”‚
â”‚                                                                             â”‚
â”‚    Default deadzone: 0.02 (keyboard), 0.05 (gamepad)                       â”‚
â”‚                                                                             â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚                                                                             â”‚
â”‚  EXPO CURVE                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚                                                                             â”‚
â”‚    output = (1 - expo) Ã— input + expo Ã— inputÂ³                             â”‚
â”‚                                                                             â”‚
â”‚    expo = 0:   Linear response                                              â”‚
â”‚    expo = 0.5: Moderate curve (default)                                    â”‚
â”‚    expo = 1:   Maximum curve (fine control at center)                      â”‚
â”‚                                                                             â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚                                                                             â”‚
â”‚  SENSITIVITY SCALING                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚                                                                             â”‚
â”‚    output = input Ã— sensitivity                                            â”‚
â”‚                                                                             â”‚
â”‚    Range: 0.3 to 3.0 (default: 1.0)                                        â”‚
â”‚                                                                             â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚                                                                             â”‚
â”‚  NORMALIZED OUTPUT                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚                                                                             â”‚
â”‚    NormalizedInput {                                                        â”‚
â”‚      throttle: 0 to 1                                                       â”‚
â”‚      yaw:      -1 to 1                                                      â”‚
â”‚      pitch:    -1 to 1                                                      â”‚
â”‚      roll:     -1 to 1                                                      â”‚
â”‚      aux1:     boolean (arm)                                                â”‚
â”‚      aux2:     number (flight mode 0-2)                                    â”‚
â”‚      aux3:     number (camera tilt -1 to 1)                                â”‚
â”‚      source:   InputSource                                                  â”‚
â”‚      timestamp: number                                                      â”‚
â”‚    }                                                                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Key Bindings

```typescript
// src/shared/constants.ts

export const DEFAULT_KEY_BINDINGS: KeyBindings = {
  // Movement (pitch/roll)
  moveUp:      ['w', 'ArrowUp'],
  moveDown:    ['s', 'ArrowDown'],
  moveLeft:    ['a', 'ArrowLeft'],
  moveRight:   ['d', 'ArrowRight'],

  // Throttle
  thrustUp:    ['Space'],
  thrustDown:  ['Shift'],

  // Yaw
  yawLeft:     ['q'],
  yawRight:    ['e'],

  // Arm state
  arm:         ['r'],
  disarm:      ['t'],

  // Flight modes
  modeAngle:   ['1'],
  modeHorizon: ['2'],
  modeAcro:    ['3'],

  // Camera
  cameraUp:    ['ArrowUp'],
  cameraDown:  ['ArrowDown'],

  // Menu
  pause:       ['p', 'Escape'],
};
```

---

## 7. Game Systems

### 7.1 Tutorial System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            TUTORIAL SYSTEM                                  â”‚
â”‚                   src/renderer/systems/TutorialSystem.ts                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  LEVELS & TASKS                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ NOVICE (3 tasks)                                                    â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ throttle_control: Reach 5m altitude                           â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ hover_practice: Maintain altitude Â±0.5m for 3 seconds         â”‚   â”‚
â”‚  â”‚   â””â”€â”€ precision_landing: Land within 0.5m of target                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ BEGINNER (4 tasks)                                                  â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ yaw_rotation: Complete 360Â° rotation                          â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ forward_backward: Move 10m forward, then back                 â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ strafe_movement: Move 10m left, then right                    â”‚   â”‚
â”‚  â”‚   â””â”€â”€ four_point_nav: Visit 4 waypoints in sequence                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ INTERMEDIATE (3 tasks)                                              â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ banking_turn: Complete coordinated turn                       â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ figure_eight: Fly figure-8 pattern                            â”‚   â”‚
â”‚  â”‚   â””â”€â”€ precision_hover_box: Hover within 1m cube for 5 seconds       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ADVANCED (2 tasks)                                                  â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ acro_intro: Fly in acro mode for 30 seconds                   â”‚   â”‚
â”‚  â”‚   â””â”€â”€ first_flip: Complete a flip maneuver                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ EXPERT (2 tasks)                                                    â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ power_loop: Complete a power loop                             â”‚   â”‚
â”‚  â”‚   â””â”€â”€ split_s: Execute split-S maneuver                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  TASK INTERFACE                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚    interface TutorialTask {                                                â”‚
â”‚      id: string;                                                           â”‚
â”‚      name: string;                                                         â”‚
â”‚      description: string;                                                  â”‚
â”‚      instructions: string[];                                               â”‚
â”‚      targetAltitude?: number;                                              â”‚
â”‚      targetPosition?: Vector3;                                             â”‚
â”‚      checkCompletion: (drone: DroneState, time: number) => boolean;        â”‚
â”‚    }                                                                       â”‚
â”‚                                                                             â”‚
â”‚  PROGRESS TRACKING                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚                                                                             â”‚
â”‚    interface TutorialProgress {                                            â”‚
â”‚      currentLevel: TutorialLevel;                                          â”‚
â”‚      currentTaskIndex: number;                                             â”‚
â”‚      completionPercentage: number;                                         â”‚
â”‚      attemptCount: number;                                                 â”‚
â”‚      completedTasks: string[];                                             â”‚
â”‚    }                                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Mission System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            MISSION SYSTEM                                   â”‚
â”‚                   src/renderer/systems/MissionSystem.ts                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  MISSION TYPES                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚                                                                             â”‚
â”‚    timeTrial   - Race through checkpoints                                  â”‚
â”‚    precision   - Land/hover at precise locations                           â”‚
â”‚    search      - Find hidden collectibles                                  â”‚
â”‚    delivery    - Transport items between locations                         â”‚
â”‚    survival    - Navigate obstacles without crashing                       â”‚
â”‚    ctf         - Capture and return objectives                             â”‚
â”‚                                                                             â”‚
â”‚  OBJECTIVE TYPES                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ Type       â”‚ Validation                                          â”‚   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚    â”‚ checkpoint â”‚ Distance to position < radius                        â”‚   â”‚
â”‚    â”‚ collect    â”‚ Distance < radius AND velocity < 2 m/s               â”‚   â”‚
â”‚    â”‚ hover      â”‚ Distance < radius AND velocity < 0.5 m/s for 3s      â”‚   â”‚
â”‚    â”‚ land       â”‚ Distance < radius AND altitude < 0.2m AND v < 0.3    â”‚   â”‚
â”‚    â”‚ photograph â”‚ Within view cone AND distance < radius               â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  SCORING                                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚                                                                             â”‚
â”‚    Base Score:                                                              â”‚
â”‚      Objective completion: +1000 points                                    â”‚
â”‚                                                                             â”‚
â”‚    Time Bonus:                                                              â”‚
â”‚      (parTime - actualTime) Ã— 100 points                                   â”‚
â”‚      Maximum: 5000 points                                                  â”‚
â”‚                                                                             â”‚
â”‚    Combo System:                                                            â”‚
â”‚      Quick successive completions increase multiplier                      â”‚
â”‚      Base: 1.0x, Max: 2.0x                                                 â”‚
â”‚      Decay: 0.1 per second without completion                              â”‚
â”‚                                                                             â”‚
â”‚    Penalties:                                                               â”‚
â”‚      Crash: -500 points, reset combo                                       â”‚
â”‚      Reset: -1000 points                                                   â”‚
â”‚                                                                             â”‚
â”‚  MISSION RESULT                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚    interface MissionResult {                                               â”‚
â”‚      missionId: string;                                                    â”‚
â”‚      completed: boolean;                                                   â”‚
â”‚      time: number;                                                         â”‚
â”‚      score: number;                                                        â”‚
â”‚      objectives: { id: string; completed: boolean }[];                     â”‚
â”‚      crashes: number;                                                      â”‚
â”‚    }                                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Rendering Pipeline

### 8.1 React Three Fiber Scene Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SCENE GRAPH HIERARCHY                                â”‚
â”‚                      src/renderer/scenes/GameScene.tsx                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  <Canvas>                                                                   â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ <Suspense fallback={<LoadingScreen />}>                             â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ <Environment />                                               â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <Sky />           // Procedural sky                     â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <ambientLight />  // Base illumination                  â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <directionalLight /> // Sun                             â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <fog />           // Distance fog                       â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ <Terrain />                                                   â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <mesh>            // Ground plane                       â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <gridHelper />    // Reference grid                     â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ <DroneModel ref={droneRef} />                                 â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <group>           // Main body                          â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <mesh> Ã— 4        // Motor arms                         â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <mesh> Ã— 4        // Propellers (animated)              â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <pointLight> Ã— 4  // Motor lights                       â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <mesh>            // LED indicators                     â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ <ParticleEffects />                                           â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <points> Ã— 4      // Thrust particles                   â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ {/* Mission Markers */}                                       â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <Checkpoint />    // Torus geometry                     â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <LandingZone />   // Ring markers                       â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ <HoverZone />     // Wireframe boxes                    â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <Collectible />   // Octahedron shapes                  â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ {/* Tutorial Markers */}                                      â”‚
â”‚    â”‚     â”‚     â””â”€â”€ <TutorialTarget /> // Green spheres + rings             â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â””â”€â”€ <PostProcessingEffects />                                     â”‚
â”‚    â”‚           â”œâ”€â”€ <EffectComposer>                                        â”‚
â”‚    â”‚           â”‚     â”œâ”€â”€ <Bloom />   // Glow effect                        â”‚
â”‚    â”‚           â”‚     â””â”€â”€ <SSAO />    // Ambient occlusion                  â”‚
â”‚    â”‚           â””â”€â”€ </EffectComposer>                                       â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â””â”€â”€ </Suspense>                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Camera System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CAMERA MODES                                      â”‚
â”‚                src/renderer/hooks/useCameraController.ts                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  MODE CONFIGURATIONS                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ Mode       â”‚ FOV   â”‚ Smoothing  â”‚ Description                     â”‚   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚    â”‚ Chase      â”‚ 75Â°   â”‚ 0.1        â”‚ Behind drone, look-ahead        â”‚   â”‚
â”‚    â”‚ FPV        â”‚ 120Â°  â”‚ 0.0        â”‚ Cockpit view, follows rotation  â”‚   â”‚
â”‚    â”‚ Orbit      â”‚ 60Â°   â”‚ 0.05       â”‚ Auto-rotating around drone      â”‚   â”‚
â”‚    â”‚ Cinematic  â”‚ 45Â°   â”‚ 0.02       â”‚ Distant, smooth tracking        â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  CHASE CAMERA ALGORITHM                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚                                                                             â”‚
â”‚    1. Calculate offset in local space:                                      â”‚
â”‚       offset = { x: 0, y: followHeight, z: -followDistance }               â”‚
â”‚                                                                             â”‚
â”‚    2. Transform to world space using drone rotation                        â”‚
â”‚                                                                             â”‚
â”‚    3. Add look-ahead based on velocity:                                    â”‚
â”‚       lookAhead = velocity * lookAheadFactor                               â”‚
â”‚                                                                             â”‚
â”‚    4. Smooth interpolation:                                                â”‚
â”‚       camera.position = lerp(current, target, smoothing)                   â”‚
â”‚                                                                             â”‚
â”‚    5. Look at drone position + lookAhead                                   â”‚
â”‚                                                                             â”‚
â”‚  FPV CAMERA ALGORITHM                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚                                                                             â”‚
â”‚    1. Position at drone location + camera offset                           â”‚
â”‚    2. Apply drone rotation directly to camera                              â”‚
â”‚    3. No smoothing (instant response)                                      â”‚
â”‚                                                                             â”‚
â”‚  ORBIT CAMERA ALGORITHM                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚                                                                             â”‚
â”‚    1. Maintain orbit angle (auto-incrementing)                             â”‚
â”‚    2. Calculate position on circle:                                        â”‚
â”‚       x = drone.x + radius * cos(angle)                                    â”‚
â”‚       z = drone.z + radius * sin(angle)                                    â”‚
â”‚       y = drone.y + height                                                 â”‚
â”‚    3. Always look at drone center                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Audio System

### 9.1 Audio Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AUDIO SYSTEM                                      â”‚
â”‚                   src/renderer/systems/AudioSystem.ts                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  WEB AUDIO API GRAPH                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚                      MOTOR SOUNDS                               â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚     â”‚
â”‚    â”‚   â”‚ Oscillatorâ”‚â”€â”€â”€>â”‚ Lowpass    â”‚â”€â”€â”€>â”‚ Gain     â”‚â”€â”€â”           â”‚     â”‚
â”‚    â”‚   â”‚ (Sawtooth)â”‚    â”‚ Filter     â”‚    â”‚ (Motor 1)â”‚  â”‚           â”‚     â”‚
â”‚    â”‚   â”‚ 100-800Hz â”‚    â”‚ fc=1000Hz  â”‚    â”‚          â”‚  â”‚           â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚     â”‚
â”‚    â”‚                                                     â”‚           â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚     â”‚
â”‚    â”‚   â”‚ Oscillatorâ”‚â”€â”€â”€>â”‚ Lowpass    â”‚â”€â”€â”€>â”‚ Gain     â”‚â”€â”€â”¤           â”‚     â”‚
â”‚    â”‚   â”‚ Motor 2   â”‚    â”‚ Filter     â”‚    â”‚ (Motor 2)â”‚  â”‚           â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚     â”‚
â”‚    â”‚                                                     â”œâ”€â”€> Mixer â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚     â”‚
â”‚    â”‚   â”‚ Oscillatorâ”‚â”€â”€â”€>â”‚ Lowpass    â”‚â”€â”€â”€>â”‚ Gain     â”‚â”€â”€â”¤           â”‚     â”‚
â”‚    â”‚   â”‚ Motor 3   â”‚    â”‚ Filter     â”‚    â”‚ (Motor 3)â”‚  â”‚           â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚     â”‚
â”‚    â”‚                                                     â”‚           â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚     â”‚
â”‚    â”‚   â”‚ Oscillatorâ”‚â”€â”€â”€>â”‚ Lowpass    â”‚â”€â”€â”€>â”‚ Gain     â”‚â”€â”€â”˜           â”‚     â”‚
â”‚    â”‚   â”‚ Motor 4   â”‚    â”‚ Filter     â”‚    â”‚ (Motor 4)â”‚              â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚     â”‚
â”‚    â”‚   â”‚ Noise     â”‚â”€â”€â”€>â”‚ Bandpass   â”‚â”€â”€â”€>â”‚ Gain     â”‚â”€â”€â”€> Mixer    â”‚     â”‚
â”‚    â”‚   â”‚ Generator â”‚    â”‚ Filter     â”‚    â”‚ (Noise)  â”‚              â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚                     EFFECTS CHANNEL                             â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚    â”‚   â”‚ Sound Effect Buffers (one-shot playback)              â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - checkpoint: 880Hz sine, 0.1s                      â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - crash: noise burst, 0.3s                          â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - arm: square wave up, 0.2s                         â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - disarm: square wave down, 0.2s                    â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - success: C5-E5-G5 chord, 0.5s                     â”‚    â”‚     â”‚
â”‚    â”‚   â”‚   - fail: descending sine, 0.4s                       â”‚    â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚    â”‚                              â”‚                                  â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                   â”‚                                         â”‚
â”‚                                   â–¼                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚                      MASTER OUTPUT                              â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚    â”‚   â”‚ Motor Mixâ”‚â”€â”€â”€>â”‚ Effects  â”‚â”€â”€â”€>â”‚ Master Gain          â”‚â”€â”€â”€> Out   â”‚
â”‚    â”‚   â”‚ Gain     â”‚    â”‚ Gain     â”‚    â”‚ (masterVolume)       â”‚     â”‚     â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚    â”‚                                                                 â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Motor Sound Calculation

```typescript
// Motor frequency based on RPM
function calculateMotorFrequency(rpm: number): number {
  const minFreq = 100;   // Hz at idle
  const maxFreq = 800;   // Hz at max RPM
  const maxRPM = 25000;  // Max motor RPM

  return minFreq + (rpm / maxRPM) * (maxFreq - minFreq);
}

// Motor volume based on RPM
function calculateMotorVolume(rpm: number, armed: boolean): number {
  if (!armed) return 0;

  const minVolume = 0.05;
  const maxVolume = 0.3;
  const maxRPM = 25000;

  return minVolume + (rpm / maxRPM) * (maxVolume - minVolume);
}
```

---

## 10. UI Components

### 10.1 UI Component Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          UI COMPONENTS                                      â”‚
â”‚                        src/renderer/ui/                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  App.tsx                                                                    â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {currentScreen === 'mainMenu' && <MainMenu />}                      â”‚
â”‚    â”‚     â”œâ”€â”€ Title / Logo                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Start Game Button                                             â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Free Play                                               â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Tutorial                                                â”‚
â”‚    â”‚     â”‚     â””â”€â”€ Missions                                                â”‚
â”‚    â”‚     â””â”€â”€ Settings Button                                               â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {currentScreen === 'settings' && <SettingsPanel />}                 â”‚
â”‚    â”‚     â”œâ”€â”€ Graphics Tab                                                  â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Resolution                                              â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Quality Preset                                          â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ VSync Toggle                                            â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Shadows Toggle                                          â”‚
â”‚    â”‚     â”‚     â””â”€â”€ Post Processing Toggle                                  â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Audio Tab                                                     â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Master Volume                                           â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Effects Volume                                          â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Music Volume                                            â”‚
â”‚    â”‚     â”‚     â””â”€â”€ Spatial Audio Toggle                                    â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Controls Tab                                                  â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Input Method Selection                                  â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Sensitivity Sliders                                     â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Deadzone Sliders                                        â”‚
â”‚    â”‚     â”‚     â”œâ”€â”€ Expo Curves                                             â”‚
â”‚    â”‚     â”‚     â””â”€â”€ Key Rebinding                                           â”‚
â”‚    â”‚     â”‚                                                                  â”‚
â”‚    â”‚     â””â”€â”€ Accessibility Tab                                             â”‚
â”‚    â”‚           â”œâ”€â”€ Motor Accessibility                                     â”‚
â”‚    â”‚           â”œâ”€â”€ Visual Accessibility                                    â”‚
â”‚    â”‚           â”œâ”€â”€ Audio Accessibility                                     â”‚
â”‚    â”‚           â””â”€â”€ Cognitive Accessibility                                 â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {currentScreen === 'pause' && <PauseMenu />}                        â”‚
â”‚    â”‚     â”œâ”€â”€ Resume Button                                                 â”‚
â”‚    â”‚     â”œâ”€â”€ Settings Button                                               â”‚
â”‚    â”‚     â””â”€â”€ Quit Button                                                   â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {isPlaying && <HUD />}                                              â”‚
â”‚    â”‚     â”œâ”€â”€ Altitude Indicator                                            â”‚
â”‚    â”‚     â”œâ”€â”€ Speed Indicator                                               â”‚
â”‚    â”‚     â”œâ”€â”€ Attitude Indicator (Artificial Horizon)                       â”‚
â”‚    â”‚     â”œâ”€â”€ Battery Level                                                 â”‚
â”‚    â”‚     â”œâ”€â”€ Flight Mode Display                                           â”‚
â”‚    â”‚     â”œâ”€â”€ Armed Status                                                  â”‚
â”‚    â”‚     â””â”€â”€ Timer / Score                                                 â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {activeMission && <MissionHUD />}                                   â”‚
â”‚    â”‚     â”œâ”€â”€ Mission Name                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Objective List                                                â”‚
â”‚    â”‚     â”œâ”€â”€ Time / Par Time                                               â”‚
â”‚    â”‚     â””â”€â”€ Score Display                                                 â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”œâ”€â”€ {tutorialActive && <TutorialOverlay />}                             â”‚
â”‚    â”‚     â”œâ”€â”€ Task Name                                                     â”‚
â”‚    â”‚     â”œâ”€â”€ Instructions                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Progress Indicator                                            â”‚
â”‚    â”‚     â””â”€â”€ Skip / Retry Buttons                                          â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â””â”€â”€ <ControlsHint />                                                    â”‚
â”‚          â””â”€â”€ Context-sensitive control hints                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 CSS Module Structure

```
ui/
â”œâ”€â”€ MainMenu.module.css          // Menu styling
â”œâ”€â”€ HUD.module.css               // Flight telemetry styling
â”œâ”€â”€ EnhancedHUD.module.css       // Advanced HUD styling
â”œâ”€â”€ SettingsPanel.module.css     // Settings form styling
â”œâ”€â”€ PauseMenu.module.css         // Pause overlay styling
â”œâ”€â”€ TutorialOverlay.module.css   // Tutorial popup styling
â”œâ”€â”€ MissionHUD.module.css        // Mission info styling
â”œâ”€â”€ ControlsHint.module.css      // Control hints styling
â””â”€â”€ LoadingScreen.module.css     // Loading indicator styling
```

---

## 11. Data Types

### 11.1 Core Types (src/shared/types.ts)

```typescript
// Input Types
type InputSource = 'keyboard' | 'mouse' | 'trackpad' | 'gamepad' | 'rc';

interface NormalizedInput {
  throttle: number;     // 0 to 1
  yaw: number;          // -1 to 1
  pitch: number;        // -1 to 1
  roll: number;         // -1 to 1
  aux1: boolean;        // Arm/Disarm
  aux2: number;         // Flight mode (0, 1, 2)
  aux3: number;         // Camera tilt (-1 to 1)
  timestamp: number;
  source: InputSource;
}

// Drone Types
type FlightMode = 'angle' | 'horizon' | 'acro';

interface DroneState {
  position: Vector3;
  rotation: Quaternion;
  velocity: Vector3;
  angularVelocity: Vector3;
  motorRPM: [number, number, number, number];
  batteryLevel: number;
  isArmed: boolean;
  flightMode: FlightMode;
}

// Game Types
type GameScreen = 'mainMenu' | 'settings' | 'tutorial' | 'freePlay' | 'mission' | 'pause';
type MissionType = 'timeTrial' | 'precision' | 'ctf' | 'search' | 'survival' | 'delivery';

// Utility Types
interface Vector3 { x: number; y: number; z: number; }
interface Quaternion { x: number; y: number; z: number; w: number; }
```

---

## 12. Configuration Constants

### 12.1 Physics Constants (src/shared/constants.ts)

```typescript
export const PHYSICS = {
  TIMESTEP: 1 / 500,           // 500Hz physics
  GRAVITY: 9.81,               // m/sÂ²
  AIR_DENSITY: 1.225,          // kg/mÂ³
  MAX_ALTITUDE: 500,           // meters
  GROUND_EFFECT_HEIGHT: 1.0,   // meters
  GROUND_EFFECT_STRENGTH: 0.3, // 30% thrust boost
};

export const DRONE_PRESETS = {
  BEGINNER: {
    mass: 0.5,
    thrustMultiplier: 1.2,
    dragCoefficient: 0.6,
    rates: { roll: 200, pitch: 200, yaw: 150 },
  },
  RACING: {
    mass: 0.35,
    thrustMultiplier: 2.0,
    dragCoefficient: 0.4,
    rates: { roll: 600, pitch: 600, yaw: 400 },
  },
  // ... more presets
};

export const INPUT = {
  TAP_DURATION: 100,           // ms
  HOLD_RAMP_SPEED: 150,        // ms to reach 100%
  KEYBOARD_DEADZONE: 0.02,
  GAMEPAD_DEADZONE: 0.05,
  LATENCY_TARGET_KEYBOARD: 8,  // ms
  LATENCY_TARGET_GAMEPAD: 16,  // ms
};

export const SCORING = {
  OBJECTIVE_POINTS: 1000,
  TIME_BONUS_PER_SECOND: 100,
  TIME_BONUS_MAX: 5000,
  CRASH_PENALTY: -500,
  RESET_PENALTY: -1000,
  COMBO_MAX: 2.0,
  COMBO_DECAY: 0.1,            // per second
};
```

---

## 13. Game Loop

### 13.1 Main Game Loop (useFrame)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           GAME LOOP (60 FPS)                                â”‚
â”‚                      Inside GameScene.tsx useFrame()                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  useFrame((state, delta) => {                                              â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 1. CLAMP DELTA TIME                                               â”‚
â”‚    â”‚  const dt = Math.min(delta, 0.05);  // Prevent physics explosion      â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 2. UPDATE INPUT                                                   â”‚
â”‚    â”œâ”€â”€> inputStore.update()                                                â”‚
â”‚    â”‚      â””â”€â”€ Poll keyboard state                                          â”‚
â”‚    â”‚      â””â”€â”€ Poll gamepad state                                           â”‚
â”‚    â”‚      â””â”€â”€ Calculate normalized input                                   â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 3. UPDATE GAME MANAGER                                            â”‚
â”‚    â”œâ”€â”€> gameManager.update(dt)                                             â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3a. Physics substeps (4x for stability)                   â”‚
â”‚    â”‚      â”œâ”€â”€> for (i = 0; i < 4; i++) {                                  â”‚
â”‚    â”‚      â”‚      physics.update(normalizedInput, dt / 4)                  â”‚
â”‚    â”‚      â”‚    }                                                           â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3b. Get new state                                         â”‚
â”‚    â”‚      â”œâ”€â”€> const physicsState = physics.getState()                    â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3c. Update game store                                     â”‚
â”‚    â”‚      â”œâ”€â”€> gameStore.updateDrone(physicsState)                        â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3d. Check for crashes                                     â”‚
â”‚    â”‚      â”œâ”€â”€> if (physics.checkCrash()) {                                â”‚
â”‚    â”‚      â”‚      gameStore.handleCrash()                                  â”‚
â”‚    â”‚      â”‚      audioSystem.playEffect('crash')                          â”‚
â”‚    â”‚      â”‚    }                                                           â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3e. Update systems                                        â”‚
â”‚    â”‚      â”œâ”€â”€> tutorialSystem?.update(droneState, dt)                     â”‚
â”‚    â”‚      â”œâ”€â”€> missionSystem?.update(droneState, dt)                      â”‚
â”‚    â”‚      â”‚                                                                â”‚
â”‚    â”‚      â”‚  // 3f. Update audio                                          â”‚
â”‚    â”‚      â””â”€â”€> audioSystem.updateMotorSounds(motorRPM, isArmed)           â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 4. UPDATE 3D SCENE                                                â”‚
â”‚    â”œâ”€â”€> droneRef.current.position.copy(droneState.position)               â”‚
â”‚    â”œâ”€â”€> droneRef.current.quaternion.copy(droneState.rotation)             â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 5. UPDATE CAMERA                                                  â”‚
â”‚    â”œâ”€â”€> cameraController.update(droneState, dt)                           â”‚
â”‚    â”‚                                                                        â”‚
â”‚    â”‚  // 6. UPDATE GAME TIME                                               â”‚
â”‚    â””â”€â”€> if (isPlaying && !isPaused) gameStore.tick(dt)                    â”‚
â”‚                                                                             â”‚
â”‚  });                                                                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 14. Performance Considerations

### 14.1 Optimization Strategies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PERFORMANCE OPTIMIZATIONS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  PHYSICS                                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚    â€¢ Fixed timestep (1/500s) prevents instability                          â”‚
â”‚    â€¢ Delta time clamped to 0.05s max                                       â”‚
â”‚    â€¢ 4 substeps per frame for smooth integration                           â”‚
â”‚    â€¢ Simple collision detection (ground plane only)                        â”‚
â”‚                                                                             â”‚
â”‚  RENDERING                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                  â”‚
â”‚    â€¢ React.memo() for pure components                                      â”‚
â”‚    â€¢ useCallback/useMemo for expensive calculations                        â”‚
â”‚    â€¢ Instanced geometry for particles                                      â”‚
â”‚    â€¢ Level-of-detail for distant objects                                   â”‚
â”‚    â€¢ Frustum culling (built into Three.js)                                 â”‚
â”‚                                                                             â”‚
â”‚  STATE                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€                                                                      â”‚
â”‚    â€¢ Zustand selectors for fine-grained subscriptions                      â”‚
â”‚    â€¢ Shallow equality checks prevent unnecessary re-renders                â”‚
â”‚    â€¢ Separate stores for different concerns                                â”‚
â”‚                                                                             â”‚
â”‚  AUDIO                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€                                                                      â”‚
â”‚    â€¢ Single AudioContext instance                                          â”‚
â”‚    â€¢ Reused oscillators for motor sounds                                   â”‚
â”‚    â€¢ One-shot buffers for effects                                          â”‚
â”‚    â€¢ Gain ramping prevents audio clicks                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 15. Extensibility Guide

### 15.1 Adding New Features

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EXTENSIBILITY GUIDE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ADD NEW DRONE PRESET                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚    1. Edit src/shared/constants.ts                                         â”‚
â”‚    2. Add to DRONE_PRESETS object                                          â”‚
â”‚    3. Update UI in SettingsPanel.tsx                                       â”‚
â”‚                                                                             â”‚
â”‚  ADD NEW FLIGHT MODE                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚    1. Add to FlightMode type in types.ts                                   â”‚
â”‚    2. Implement behavior in PhysicsEngine.ts                               â”‚
â”‚    3. Add key binding in constants.ts                                      â”‚
â”‚    4. Update HUD display                                                   â”‚
â”‚                                                                             â”‚
â”‚  ADD NEW MISSION TYPE                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚    1. Add to MissionType in types.ts                                       â”‚
â”‚    2. Implement in MissionSystem.ts                                        â”‚
â”‚    3. Add objective validation logic                                       â”‚
â”‚    4. Create mission markers in GameScene.tsx                              â”‚
â”‚                                                                             â”‚
â”‚  ADD NEW TUTORIAL LEVEL                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚    1. Add to TutorialLevel type in types.ts                                â”‚
â”‚    2. Define tasks in TutorialSystem.ts                                    â”‚
â”‚    3. Update progression logic                                             â”‚
â”‚                                                                             â”‚
â”‚  ADD NEW CAMERA MODE                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚    1. Add mode to CameraMode type                                          â”‚
â”‚    2. Add config in useCameraController.ts                                 â”‚
â”‚    3. Implement update logic                                               â”‚
â”‚    4. Add key binding                                                      â”‚
â”‚                                                                             â”‚
â”‚  ADD NEW SOUND EFFECT                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚    1. Generate buffer in AudioSystem.ts                                    â”‚
â”‚    2. Add to effects map                                                   â”‚
â”‚    3. Call audioSystem.playEffect('name')                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Conclusie

Dit document biedt een complete technische referentie voor de Aetherwing Drone Simulator. De architectuur is ontworpen voor:

- **Modulariteit**: Gescheiden concerns via stores en systems
- **Performance**: Geoptimaliseerde physics en rendering
- **Uitbreidbaarheid**: Eenvoudig nieuwe features toevoegen
- **Toegankelijkheid**: Uitgebreide a11y ondersteuning

Voor vragen of bijdragen, zie de [README.md](./README.md) of open een issue op GitHub.

---

*Document versie: 1.0.0*
*Laatste update: 2025*
